
import { chatItms } from "../../../../utils/mockData";
import ChatAvatar from "../chatList/ChatAvatar";
import ChatContentItems from "./ChatContentItems";
import { useState, useRef, useEffect } from "react";

function ChatContent() {


    const messagesEndRef = useRef(null);
    const [chat, setChat] = useState(chatItms);
    const [msg, setMsg] = useState("");

    const scrollToBottom = () => {
        messagesEndRef.current.scrollIntoView({ behavior: "smooth" });
    };

    useEffect(() => {
        window.addEventListener("keydown", (e) => {
            if (e.key === 13) {
                if (msg !== "") {
                    const newChatItem = {
                        key: 1,
                        type: "",
                        msg: msg,
                        image:
                            "https://pbs.twimg.com/profile_images/1116431270697766912/-NfnQHvh_400x400.jpg",
                    };
                    setChat([...chat, newChatItem]);
                    scrollToBottom();
                    setMsg("");
                }
            }
        });
        scrollToBottom();
    }, [msg, chat]);

    const onStateChange = (e) => {
        setMsg(e.target.value);
    };


    return (
        <div className="main__chatcontent">
            <div className="content__header">
                <div className="blocks">
                    <div className="current-chatting-user">
                        <ChatAvatar
                            isOnline="active"
                            image=""
                        />
                        <p>Tim Hover</p>
                    </div>
                </div>

                <div className="blocks">
                    <div className="settings">
                        <button className="btn-nobg">
                            <i className="fa fa-cog"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div className="content__body">
                <div className="chat__items">
                    {chat.map((itm, index) => (
                        <ChatContentItems
                            animationDelay={index + 2}
                            key={itm.key}
                            user={itm.type ? itm.type : "me"}
                            msg={itm.msg}
                            image={itm.image}
                        />
                    ))}
                    <div ref={messagesEndRef} />
                </div>
            </div>
            <div className="content__footer">
                <div className="sendNewMessage">
                    <button className="addFiles">
                        <i className="fa fa-plus"></i>
                    </button>
                    <input
                        type="text"
                        placeholder="Type a message here"
                        onChange={onStateChange}
                        value={msg}
                    />
                    <button className="">
                        <svg xmlns="http://www.w3.org/2000/svg" className="" viewBox="0 0 13 18" fill="none">
                            <path d="M2.36817 6.85032C2.36817 4.22585 2.76287 0.726562 6.31513 0.726562C9.86738 0.726562 10.2621 4.22585 10.2621 6.85032C10.2621 9.47479 9.86738 12.9741 6.31513 12.9741C2.76287 12.9741 2.36817 9.47479 2.36817 6.85032Z" fill="currentColor" />
                            <path d="M0.789391 8.38126C0.353422 8.38126 0 8.72397 0 9.14673C0 11.5704 1.72594 14.8317 5.52682 15.2301C5.5261 15.2435 5.52574 15.2569 5.52574 15.2705V16.036H3.94695C3.51099 16.036 3.15756 16.3787 3.15756 16.8014C3.15756 17.2242 3.51099 17.5669 3.94695 17.5669H8.6833C9.11927 17.5669 9.47269 17.2242 9.47269 16.8014C9.47269 16.3787 9.11927 16.036 8.6833 16.036H7.10452V15.2705C7.10452 15.2569 7.10415 15.2435 7.10343 15.2301C10.9043 14.8317 12.6303 11.5704 12.6303 9.14673C12.6303 8.72397 12.2768 8.38126 11.8409 8.38126C11.4049 8.38126 11.0515 8.72397 11.0515 9.14673C11.0515 11.1542 9.54199 13.7396 6.31513 13.7396C3.08826 13.7396 1.57878 11.1542 1.57878 9.14673C1.57878 8.72397 1.22536 8.38126 0.789391 8.38126Z" fill="currentColor" />
                        </svg>
                    </button>
                    <button className="">
                        <svg xmlns="http://www.w3.org/2000/svg" className="" viewBox="0 0 18 18" fill="none">
                            <path d="M5.54166 7.04169C5.54166 6.26663 6.16997 5.63833 6.94502 5.63833C7.72008 5.63833 8.34839 6.26663 8.34839 7.04169C8.34839 7.81674 7.72008 8.44505 6.94502 8.44505C6.16997 8.44505 5.54166 7.81674 5.54166 7.04169Z" fill="currentColor" />
                            <path fillRule="evenodd" clipRule="evenodd" d="M1.45382 13.6331C1.29886 13.7768 1.04591 13.7106 0.997307 13.5049C0.729456 12.3714 0.629883 10.9416 0.629883 9.14673C0.629883 2.21272 2.11604 0.726562 9.05005 0.726562C15.9841 0.726562 17.4702 2.21272 17.4702 9.14673C17.4702 9.16989 17.4702 9.193 17.4702 9.21604C17.4702 9.21863 17.4675 9.22035 17.4651 9.21928C17.0217 9.01724 16.3926 8.78134 15.6592 8.65562C14.1728 8.40081 12.2331 8.60335 10.627 10.4389C9.2536 12.0085 8.66136 12.1334 8.21743 12.1052C7.97971 12.0901 7.75222 12.0303 7.41849 11.9425C7.31772 11.916 7.20726 11.8869 7.08391 11.8558C6.58369 11.7295 5.97312 11.6026 5.19082 11.6026C4.57995 11.6026 3.97437 11.8414 3.45398 12.1285C2.9224 12.4218 2.41212 12.8037 1.97598 13.1709C1.78984 13.3277 1.61451 13.4841 1.45382 13.6331ZM4.1383 7.04169C4.1383 5.49158 5.39491 4.23497 6.94502 4.23497C8.49513 4.23497 9.75175 5.49158 9.75175 7.04169C9.75175 8.5918 8.49513 9.84841 6.94502 9.84841C5.39492 9.84841 4.1383 8.5918 4.1383 7.04169Z" fill="currentColor" />
                            <path d="M1.8865 15.1703C1.7957 15.2631 1.78208 15.4073 1.8588 15.5121C3.02756 17.1083 5.1983 17.5669 9.05005 17.5669C15.394 17.5669 17.1778 16.3229 17.4355 10.801C17.4359 10.792 17.4314 10.7831 17.4237 10.7783L17.413 10.7717C17.3905 10.7581 17.3546 10.7368 17.3065 10.7098C17.2102 10.6558 17.066 10.5796 16.8833 10.4963C16.5154 10.3287 16.0043 10.1386 15.4221 10.0388C14.2772 9.84253 12.8838 9.99083 11.6832 11.363C10.2499 13.001 9.26335 13.5778 8.1285 13.5058C7.74044 13.4811 7.34105 13.375 6.98507 13.2804C6.90082 13.258 6.81901 13.2363 6.74036 13.2164C6.2977 13.1047 5.81188 13.006 5.19082 13.006C4.92459 13.006 4.56537 13.1181 4.13191 13.3572C3.70964 13.5902 3.27704 13.91 2.87993 14.2444C2.48526 14.5767 2.14024 14.9111 1.89324 15.1634C1.89098 15.1657 1.88873 15.168 1.8865 15.1703Z" fill="currentColor" />
                        </svg>
                    </button>
                    <button className="">
                        <svg xmlns="http://www.w3.org/2000/svg" className="" viewBox="0 0 14 19" fill="none">
                            <path d="M5.95826 7.07088C5.57613 6.96932 5.18205 7.19695 5.08355 7.57699C3.76796 12.6528 4.1427 13.9439 6.87193 14.6692C9.72087 15.4264 10.6587 14.3774 12.1854 8.72586C13.7122 3.07437 13.4288 1.7008 10.5799 0.943647C8.89025 0.494602 7.87283 0.680834 7.0061 2.08566C6.7745 2.46104 7.00221 2.93502 7.43079 3.04892L7.45398 3.05509C7.78265 3.14244 8.11905 2.98231 8.30881 2.70217C8.37568 2.60346 8.43915 2.522 8.49918 2.45485C8.68802 2.24363 8.8281 2.1864 8.98566 2.16174C9.20569 2.12732 9.56988 2.14633 10.2091 2.3162C10.8483 2.48608 11.1732 2.65023 11.3464 2.78916C11.4705 2.88866 11.5629 3.00768 11.62 3.28426C11.6884 3.61612 11.6965 4.14872 11.563 5.0182C11.4315 5.87487 11.1793 6.9602 10.8016 8.35809C10.424 9.75598 10.0953 10.821 9.77734 11.6281C9.45465 12.4473 9.1792 12.9046 8.95261 13.158C8.76377 13.3692 8.6237 13.4265 8.46613 13.4511C8.2461 13.4855 7.88192 13.4665 7.24272 13.2966C6.60353 13.1268 6.27856 12.9626 6.10536 12.8237C5.98133 12.7242 5.88887 12.6052 5.83181 12.3286C5.76334 11.9967 5.7553 11.4641 5.8888 10.5947C5.99794 9.88387 6.19013 9.01569 6.46813 7.94216C6.56654 7.56211 6.34039 7.17243 5.95826 7.07088Z" fill="currentColor" />
                            <path d="M3.36259 16.6789C4.00178 16.8488 4.36597 16.8678 4.586 16.8334C4.74356 16.8087 4.88364 16.7515 5.07248 16.5403C5.13251 16.4731 5.19598 16.3917 5.26285 16.293C5.45261 16.0128 5.78901 15.8527 6.11768 15.9401L6.14087 15.9462C6.56945 16.0601 6.79716 16.5341 6.56556 16.9095C5.69883 18.3143 4.68141 18.5005 2.9918 18.0515C0.142863 17.2943 -0.140522 15.9208 1.38622 10.2693C2.91296 4.61778 3.85079 3.56878 6.69973 4.32593C9.42896 5.05128 9.8037 6.34232 8.48811 11.4182C8.38961 11.7982 7.99553 12.0258 7.6134 11.9243C7.23127 11.8227 7.00512 11.433 7.10353 11.053C7.38152 9.97946 7.57372 9.11127 7.68286 8.40049C7.81636 7.53101 7.80832 6.99841 7.73985 6.66654C7.68279 6.38997 7.59032 6.27094 7.4663 6.17145C7.2931 6.03252 6.96813 5.86837 6.32893 5.69849C5.68974 5.52861 5.32556 5.50961 5.10553 5.54403C4.94796 5.56869 4.80789 5.62591 4.61905 5.83713C4.39246 6.09058 4.11701 6.54784 3.79432 7.36704C3.47638 8.17417 3.14767 9.23916 2.77004 10.6371C2.3924 12.0349 2.1402 13.1203 2.00867 13.9769C1.87517 14.8464 1.88321 15.379 1.95168 15.7109C2.00874 15.9875 2.1012 16.1065 2.22523 16.206C2.39842 16.3449 2.7234 16.5091 3.36259 16.6789Z" fill="currentColor" />
                        </svg>
                    </button>

                    <button className="p-1 bg-black text-white flex gap-2">
                        <p>Send</p>
                        <svg xmlns="http://www.w3.org/2000/svg" className="" viewBox="0 0 26 26" fill="none">
                            <path d="M23.8845 13.0179C23.8784 13.7769 23.4587 14.4218 23.1147 14.8512C22.7307 15.3304 22.2192 15.8091 21.6554 16.265C20.5217 17.1816 19.0237 18.1277 17.4779 18.9345C15.9342 19.7403 14.2791 20.4405 12.8217 20.8329C12.0956 21.0284 11.3686 21.1613 10.7023 21.1731C10.0656 21.1844 9.29813 21.0892 8.66299 20.6373L8.65954 20.6348C8.54031 20.5494 8.43685 20.4535 8.40036 20.4197L8.3934 20.4132C8.02409 20.0727 7.8428 19.6412 7.74596 19.3196C7.64242 18.9758 7.59112 18.6073 7.57025 18.2538C7.5284 17.5452 7.60017 16.7421 7.75891 15.9883C7.84589 15.5752 7.96525 15.1469 8.12241 14.7373C8.35555 14.1296 8.94758 13.7662 9.59397 13.6863L13.3377 13.3799C13.5294 13.3642 13.6766 13.2042 13.6763 13.0119C13.676 12.8195 13.5283 12.6591 13.3366 12.6428L9.59194 12.3252C8.90457 12.2383 8.27624 11.8426 8.04377 11.1895C7.89513 10.7719 7.78426 10.3368 7.70639 9.916C7.55935 9.12131 7.50993 8.2684 7.59784 7.51878C7.6417 7.14476 7.72508 6.74948 7.87777 6.38435C8.02532 6.03152 8.28529 5.59429 8.75031 5.29667L8.75107 5.29618C9.38615 4.88986 10.1412 4.82035 10.7664 4.84494C11.4248 4.87084 12.1452 5.01069 12.8687 5.21093C14.3204 5.61271 15.97 6.31024 17.5101 7.11064C19.051 7.91145 20.5449 8.84783 21.6738 9.75717C22.235 10.2092 22.7456 10.6861 23.128 11.1662C23.4714 11.5973 23.8907 12.2494 23.8845 13.0179Z" fill="currentColor" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    )
}

export default ChatContent